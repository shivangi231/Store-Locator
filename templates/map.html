<!DOCTYPE html>
<html>
  <head>
    <title>Shops</title>
    <!-- BOOTSTRAP STYLES-->
      <link href="/css/shop_profile_bootstrap.css" rel="stylesheet" />
       <!-- FONTAWESOME STYLES-->
      <link href="/css/shop_profile_font-awesome.css" rel="stylesheet" />
          <!-- CUSTOM STYLES-->
      <link href="/css/shop_profile_custom.css" rel="stylesheet" />
       <!-- GOOGLE FONTS-->
     <link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css' />

    <style>
      html, body, #map-canvas {
        height: 100%;
        margin: 0px;
        padding: 0px
      }
      #panel {
        position: absolute;
        top: 5px;
        left: 50%;
        margin-left: -180px;
        z-index: 5;
        background-color: #fff;
        padding: 5px;
        border: 1px solid #999;
      }
    </style>
    <script src="https://maps.googleapis.com/maps/api/js"></script>
    <script>
// In the following example, markers appear when the user clicks on the map.
// The markers are stored in an array.
// The user can then click an option to hide, show or delete the markers.
var map;
var cordinates = [];
var temp = []
{%for shop in shops%}
cordinates.push(new google.maps.LatLng({{shop[0].location.lat}},{{shop[0].location.lon}}));
temp.push("<b> {{shop[0].shop_name}} </b><br> {{shop[0].shop_address}} <br> {{shop[0].mobile}} <br> Recommendation Index = {{shop[1]}}")
{%endfor%}

var trip=cordinates;
var markers = [];
function initialize() {
  var mapOptions = {
    zoom: 12,
    center:cordinates[0],
    mapTypeId: google.maps.MapTypeId.ROADMAP
  };
  map = new google.maps.Map(document.getElementById('map-canvas'),
      mapOptions);
  //infowindowopen(map,marker);
  //This event listener will call addMarker() when the map is clicked.
  //google.maps.event.addListener(map, 'click', function(event) {
   // addMarker(event.latLng);
  //});

  for(var i=0;i<trip.length;i++){
    addMarker(trip[i],i);
  }
  // Adds a marker at the center of the map.
  //addMarker(haightAshbury);
}
// Add a marker to the map and push to the array.
function addMarker(location,i) {
  var marker = new google.maps.Marker({
    position: location,
    map: map
  });
  var infowindow = new google.maps.InfoWindow({
    content: temp[i]
  });
  infowindow.open(map,marker);
  markers.push(marker);
}
// Sets the map on all markers in the array.
function setAllMap(map) {
  for (var i = 0; i < markers.length; i++) {
    markers[i].setMap(map);
  }
}
// Removes the markers from the map, but keeps them in the array.
// Shows any markers currently in the array.
function showMarkers() {
  setAllMap(map);
}
google.maps.event.addDomListener(window, 'load', initialize);
    </script>
  </head>
  <body>
    <div id="wrapper">
        <nav class="navbar navbar-default navbar-cls-top " role="navigation" style="margin-bottom: 0">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".sidebar-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/profile">{{fname}}</a>
            </div>
  <div style="color: white;
padding: 15px 50px 5px 50px;
float: right;
font-size: 16px;"> <a href="/logout?url=/" class="btn btn-danger square-btn-adjust">Logout</a> </div>
        </nav>
           <!-- /. NAV TOP  -->
                <nav class="navbar-default navbar-side" role="navigation">
            <div class="sidebar-collapse">
                <ul class="nav" id="main-menu">
                  <li class="text-center">
                              <img src="/images/shop_profile_image/find_user.png" class="user-image img-responsive"/>
                  </li>

                    {%for shop in shops%}
                    <li>
                        <a  href="/shop/shopprofile/{{shop[0].key.id()}}">{{shop[0].shop_name}} <em> {{shop[1]}} </em> <span class="glyphicon glyphicon-menu-right" aria-hidden="true"> </span></a>
                    </li>
                    {%endfor%}

                </ul>

            </div>

        </nav>

</div>
      <div id="map-canvas"></div>
      <input name = "shop cordinates" type = "hidden">
      <p>Click on the map to add markers.</p>




</div>
     <!-- /. PAGE INNER  -->
    </div>
 <!-- /. PAGE WRAPPER  -->

<!-- /. WRAPPER  -->
<!-- SCRIPTS -AT THE BOTOM TO REDUCE THE LOAD TIME-->
<!-- JQUERY SCRIPTS -->
<script src="/js/jquery-1.10.2.js"></script>
<!-- BOOTSTRAP SCRIPTS -->
<script src="/js/bootstrap.min.js"></script>
<!-- METISMENU SCRIPTS -->
<script src="/js/jquery.metisMenu.js"></script>
<!-- DATA TABLE SCRIPTS -->
<script src="/js/dataTables/jquery.dataTables.js"></script>
<script src="/js/dataTables/dataTables.bootstrap.js"></script>
<script>
    $(document).ready(function () {
        $('#dataTables-example').dataTable();
    });
</script>

<!-- CUSTOM SCRIPTS -->
<script src="/js/shop_profile_custom.js"></script>



  </body>
</html>
